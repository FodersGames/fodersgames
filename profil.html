<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FodersGames - Profile</title>
  <link rel="stylesheet" href="styles.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;700&display=swap" rel="stylesheet">
  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      padding: 0;
      background: #f8f9fa;
      color: #333;
      overflow-x: hidden;
    }
    .banner {
      background-color: #fff;
      color: #000;
      padding: 15px 0;
      text-align: center;
      font-weight: bold;
      font-size: 24px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    .container {
      width: 80%;
      margin: auto;
      max-width: 1200px;
    }
    main {
      padding-bottom: 50px;
    }
    .profile-container {
      width: 80%;
      max-width: 320px; /* R√©duction de la taille */
      margin: auto;
      padding: 20px; /* R√©duction du padding */
      border-radius: 10px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      background: #fff;
      text-align: center;
      margin-top: 40px;
      margin-bottom: 40px;
    }
    .profile-pic {
      width: 100px; /* R√©duction de la taille de l‚Äôimage */
      height: 100px;
      border-radius: 50%;
      object-fit: cover;
      border: 3px solid #007bff;
    }
    .file-input {
      display: none;
    }
    .upload-btn, .save-btn {
      display: inline-block;
      padding: 10px 18px; /* Boutons plus petits */
      background: #007bff;
      color: #fff;
      font-weight: bold;
      border: none;
      cursor: pointer;
      border-radius: 5px;
      transition: background 0.3s ease;
      margin-top: 10px;
      text-decoration: none;
      font-size: 14px; /* Texte plus petit */
      text-align: center;
    }
    .upload-btn:hover, .save-btn:hover {
      background: #0056b3;
    }
    .home-btn {
      position: absolute;
      top: 15px;
      right: 20px;
      background: #007bff;
      color: #fff;
      font-weight: bold;
      border: none;
      cursor: pointer;
      border-radius: 50%;
      transition: background 0.3s ease;
      text-decoration: none;
      font-size: 20px;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .home-btn:hover {
      background: #0056b3;
    }
    .input-group {
      text-align: left;
      margin-bottom: 12px; /* Espacement r√©duit */
    }
    .input-group label {
      font-weight: bold;
      display: block;
      margin-bottom: 5px;
    }
    .input-group input, .input-group textarea {
      width: 90%;
      padding: 8px; /* Champs plus petits */
      border: 2px solid #ccc;
      border-radius: 5px;
      font-size: 14px;
    }
    .success-message {
      color: green;
      margin-top: 10px;
      display: none;
    }
  </style>
</head>
<body>
  <div class="banner">
    FodersGames
  </div>

  <main>
    <section class="profile-container">
      <h2>Profile</h2>
      <img id="profile-pic" class="profile-pic" src="https://cdn.pixabay.com/photo/2018/11/13/21/43/avatar-3814049_1280.png" alt="Profile Picture">
      <input type="file" id="file-input" class="file-input" accept="image/*">
      <button class="upload-btn" onclick="document.getElementById('file-input').click();">Upload Image</button>
      
      <div class="input-group">
        <label for="name">Name</label>
        <input type="text" id="name" placeholder="Your name">
      </div>
      <div class="input-group">
        <label for="email">Email</label>
        <input type="email" id="email" placeholder="Your email">
      </div>
      <div class="input-group">
        <label for="bio">Bio</label>
        <textarea id="bio" placeholder="Tell something about yourself..."></textarea>
      </div>
      <div class="input-group">
        <label for="password">New Password</label>
        <input type="password" id="password" placeholder="Leave blank to keep the same">
      </div>
      <button class="save-btn" onclick="saveProfile()">Save Changes</button>
      <p id="success-message" class="success-message">Profile updated successfully!</p>

      <!-- Bouton retour √† l'accueil -->
      <a href="home.html" class="home-btn">üè†</a>
    </section>
  </main>

  <script>
    // Lors du chargement de la page, remplir les champs avec les valeurs stock√©es
    document.addEventListener("DOMContentLoaded", function() {
      document.getElementById("name").value = localStorage.getItem("name") || "";
      document.getElementById("email").value = localStorage.getItem("email") || "";
      document.getElementById("bio").value = localStorage.getItem("bio") || "";
      document.getElementById("profile-pic").src = localStorage.getItem("profilePic") || "https://cdn.pixabay.com/photo/2018/11/13/21/43/avatar-3814049_1280.png";
    });
    
    function saveProfile() {
      // R√©cup√©rer l'ancien email stock√© (pour l'identifier dans l'objet utilisateur)
      const oldEmail = localStorage.getItem("email") || "";
      const newEmail = document.getElementById("email").value;
      
      // Mettre √† jour les autres informations
      localStorage.setItem("name", document.getElementById("name").value);
      localStorage.setItem("bio", document.getElementById("bio").value);
      
      let password = document.getElementById("password").value;
      if (password.length > 0) {
        localStorage.setItem("password", password);
      }
      
      // Si l'email a √©t√© modifi√©, mettre √† jour l'objet utilisateur stock√© sous l'ancien email
      if (newEmail !== oldEmail) {
        const userObj = JSON.parse(localStorage.getItem(oldEmail));
        if (userObj) {
          // Supprimer l'ancien enregistrement
          localStorage.removeItem(oldEmail);
          // Mettre √† jour l'email dans l'objet
          userObj.email = newEmail;
          // Enregistrer l'objet utilisateur sous la nouvelle cl√©
          localStorage.setItem(newEmail, JSON.stringify(userObj));
        }
      }
      
      // Mettre √† jour la cl√© "email" pour la connexion
      localStorage.setItem("email", newEmail);
      
      // Afficher le message de succ√®s
      document.getElementById("success-message").style.display = "block";
      setTimeout(() => document.getElementById("success-message").style.display = "none", 3000);
    }
    
    // Gestion du changement d'image de profil
    document.getElementById("file-input").addEventListener("change", function(event) {
      let reader = new FileReader();
      reader.onload = function() {
        let profilePic = reader.result;
        document.getElementById("profile-pic").src = profilePic;
        localStorage.setItem("profilePic", profilePic);
      }
      reader.readAsDataURL(event.target.files[0]);
    });
  </script>
</body>
</html>
